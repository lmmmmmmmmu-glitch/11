<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¹é‡å·ç ç”Ÿæˆä¸æ–‡ä»¶åˆ†å‰²å·¥å…·</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 0;
            padding: 20px;
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 35px;
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, #4d90fe, #34a853, #fbbc05, #ea4335);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-top: 0;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
            font-weight: 700;
            position: relative;
        }
        
        h1::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #4d90fe, #34a853);
            border-radius: 2px;
        }
        
        .description {
            background: linear-gradient(135deg, #f0f7ff, #e6f3ff);
            border-left: 5px solid #4d90fe;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 0 10px 10px 0;
            font-size: 15px;
            line-height: 1.6;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .input-section {
            margin-bottom: 30px;
        }
        
        .input-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .input-group {
            flex: 1;
        }
        
        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #444;
            font-size: 16px;
        }
        
        .input-label i {
            color: #4d90fe;
            margin-right: 8px;
        }
        
        .input-with-unit {
            position: relative;
        }
        
        .unit-label {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            font-size: 16px;
        }
        
        .filename-input, .number-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .filename-input:focus, .number-input:focus {
            border-color: #4d90fe;
            box-shadow: 0 0 0 3px rgba(77, 144, 254, 0.2);
            outline: none;
        }
        
        .filename-hint {
            font-size: 13px;
            color: #666;
            margin-top: 8px;
            padding-left: 5px;
        }
        
        .filename-example {
            background-color: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 13px;
            color: #555;
            margin-top: 5px;
            border-left: 3px solid #4d90fe;
        }
        
        textarea {
            width: 100%;
            min-height: 400px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s;
        }
        
        textarea:focus {
            border-color: #4d90fe;
            box-shadow: 0 0 0 3px rgba(77, 144, 254, 0.2);
            outline: none;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 14px 32px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 160px;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #4d90fe, #357ae8);
            color: white;
            box-shadow: 0 4px 12px rgba(77, 144, 254, 0.3);
        }
        
        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(77, 144, 254, 0.4);
        }
        
        .generate-btn:active {
            transform: translateY(-1px);
        }
        
        .reset-btn {
            background: linear-gradient(135deg, #f1f3f4, #e0e0e0);
            color: #444;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .reset-btn:hover {
            background: linear-gradient(135deg, #e8eaed, #d5d5d5);
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.12);
        }
        
        .status-section {
            background: linear-gradient(135deg, #f9f9f9, #f0f0f0);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 1px solid #eaeaea;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .status-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .status-title {
            font-weight: 700;
            color: #2c3e50;
            font-size: 18px;
        }
        
        #statusText {
            font-weight: 600;
            color: #4d90fe;
        }
        
        .progress-container {
            height: 12px;
            background-color: #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 25px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4d90fe, #34a853);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 6px;
        }
        
        .file-list {
            margin-top: 25px;
        }
        
        .file-list-header {
            font-weight: 700;
            color: #2c3e50;
            font-size: 18px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            transition: all 0.2s;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .file-item:hover {
            background-color: #f9f9f9;
            transform: translateX(5px);
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .file-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #4d90fe, #34a853);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .file-details {
            display: flex;
            flex-direction: column;
        }
        
        .file-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        .file-size {
            color: #666;
            font-size: 14px;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #34a853, #2e8b47);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 15px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(52, 168, 83, 0.3);
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(52, 168, 83, 0.4);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .stat-box {
            background: linear-gradient(135deg, #f8f9fa, #f0f2f5);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #eaeaea;
            transition: all 0.3s;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 800;
            color: #4d90fe;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 15px;
            color: #666;
            font-weight: 600;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 30px;
        }
        
        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #4d90fe;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px auto;
        }
        
        .loading-text {
            font-size: 18px;
            font-weight: 600;
            color: #444;
        }
        
        .note {
            font-size: 14px;
            color: #888;
            margin-top: 25px;
            text-align: center;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 4px solid #fbbc05;
        }
        
        .example-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #34a853;
        }
        
        .example-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .example-content {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background-color: #fff;
            padding: 15px;
            border-radius: 6px;
            font-size: 14px;
            line-height: 1.5;
            overflow-x: auto;
        }
        
        /* ä¸Šä¼ åŒºåŸŸæ ·å¼ */
        .upload-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f9f9f9, #f0f0f0);
            border-radius: 12px;
            border: 1px solid #eaeaea;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .upload-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .upload-title {
            font-weight: 700;
            color: #2c3e50;
            font-size: 18px;
        }
        
        #uploadStatus {
            font-weight: 600;
            color: #4d90fe;
        }
        
        .upload-area {
            border: 2px dashed #c3cfe2;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }
        
        .upload-area:hover {
            border-color: #4d90fe;
            background-color: #f5f7fa;
        }
        
        .upload-icon {
            font-size: 48px;
            color: #4d90fe;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .upload-hint {
            font-size: 14px;
            color: #888;
        }
        
        .upload-btn {
            background: linear-gradient(135deg, #fbbc05, #f9ab00);
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(251, 188, 5, 0.3);
            margin-top: 15px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(251, 188, 5, 0.4);
        }
        
        .upload-results {
            margin-top: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            border-left: 4px solid #34a853;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .result-label {
            font-weight: 600;
            color: #444;
        }
        
        .result-value {
            font-weight: 600;
            color: #4d90fe;
        }
        
        .download-clean-btn {
            background: linear-gradient(135deg, #34a853, #2e8b47);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 15px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(52, 168, 83, 0.3);
            display: inline-block;
            margin-top: 15px;
        }
        
        .download-clean-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(52, 168, 83, 0.4);
        }
        
        /* æ–°å¢çš„åˆ†ç±»å·¥å…·æ ·å¼ */
        .classification-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f9f9f9, #f0f0f0);
            border-radius: 12px;
            border: 1px solid #eaeaea;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .classification-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .classification-title {
            font-weight: 700;
            color: #2c3e50;
            font-size: 18px;
        }
        
        #classificationStatus {
            font-weight: 600;
            color: #4d90fe;
        }
        
        .classification-options {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .option-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .option-label {
            font-weight: 600;
            color: #444;
        }
        
        .prefix-length-select {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            background-color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .prefix-length-select:focus {
            border-color: #4d90fe;
            box-shadow: 0 0 0 3px rgba(77, 144, 254, 0.2);
            outline: none;
        }
        
        .classification-area {
            border: 2px dashed #c3cfe2;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }
        
        .classification-area:hover {
            border-color: #4d90fe;
            background-color: #f5f7fa;
        }
        
        .classification-icon {
            font-size: 48px;
            color: #ea4335;
            margin-bottom: 15px;
        }
        
        .classification-text {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .classification-hint {
            font-size: 14px;
            color: #888;
        }
        
        .classification-btn {
            background: linear-gradient(135deg, #ea4335, #d93025);
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 8px rgba(234, 67, 53, 0.3);
            margin-top: 15px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .classification-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(234, 67, 53, 0.4);
        }
        
        .classification-results {
            margin-top: 20px;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            border-left: 4px solid #34a853;
            display: none;
        }
        
        .results-header {
            font-weight: 700;
            color: #2c3e50;
            font-size: 18px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .classification-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .classification-stat {
            background: linear-gradient(135deg, #f8f9fa, #f0f2f5);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #eaeaea;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: 800;
            color: #ea4335;
            margin-bottom: 5px;
        }
        
        .stat-desc {
            font-size: 14px;
            color: #666;
        }
        
        .classification-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #eaeaea;
            border-radius: 8px;
            padding: 10px;
        }
        
        .classification-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            transition: all 0.2s;
        }
        
        .classification-item:hover {
            background-color: #f9f9f9;
        }
        
        .prefix-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .prefix-badge {
            background: linear-gradient(135deg, #4d90fe, #357ae8);
            color: white;
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: 600;
            min-width: 60px;
            text-align: center;
        }
        
        .prefix-count {
            font-weight: 600;
            color: #444;
        }
        
        .download-classify-btn {
            background: linear-gradient(135deg, #ea4335, #d93025);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .download-classify-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 3px 8px rgba(234, 67, 53, 0.4);
        }
        
        .download-all-btn {
            background: linear-gradient(135deg, #fbbc05, #f9ab00);
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .download-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(251, 188, 5, 0.4);
        }
        
        .actions-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .input-row {
                flex-direction: column;
                gap: 15px;
            }
            
            button {
                min-width: 140px;
                padding: 12px 20px;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .classification-options {
                flex-direction: column;
                gap: 15px;
            }
            
            .actions-row {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .download-all-btn, .reset-btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .file-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .download-btn {
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>æ‰¹é‡å·ç ç”Ÿæˆä¸æ–‡ä»¶åˆ†å‰²å·¥å…·</h1>
        
        <div class="description">
            <p><strong>åŠŸèƒ½è¯´æ˜ï¼š</strong> æœ¬å·¥å…·æ ¹æ®æ‚¨æä¾›çš„å·ç æ®µè§„åˆ™ï¼Œè‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„å·ç åºåˆ—ã€‚æ‚¨å¯ä»¥è‡ªå®šä¹‰æ¯ä¸ªæ–‡ä»¶åŒ…å«çš„æ•°æ®é‡ã€‚ç”Ÿæˆçš„æ–‡ä»¶å°†æŒ‰ç…§æ‚¨æŒ‡å®šçš„æ ¼å¼å‘½åã€‚</p>
        </div>
        
        <div class="input-section">
            <div class="input-row">
                <div class="input-group">
                    <label class="input-label"><i>ğŸ“</i> è¾“å‡ºæ–‡ä»¶åç§°ï¼š</label>
                    <input type="text" id="filenameInput" class="filename-input" placeholder="ä¾‹å¦‚: 0455å®‰è¾¾å¸‚-0453ç©†é™µå¸‚" value="">
                    <div class="filename-hint">è¯·è¾“å…¥ç”Ÿæˆæ–‡ä»¶çš„åŸºæœ¬åç§°ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ·»åŠ åºå·ï¼ˆå¦‚ï¼šæ–‡ä»¶å_1.xlsxï¼‰</div>
                    <div class="filename-example">ç¤ºä¾‹ï¼šè¾“å…¥"æµ‹è¯•æ•°æ®"å°†ç”Ÿæˆ"æµ‹è¯•æ•°æ®.xlsx"ã€"æµ‹è¯•æ•°æ®_2.xlsx"ç­‰</div>
                </div>
                
                <div class="input-group">
                    <label class="input-label"><i>ğŸ”¢</i> æ¯æ–‡ä»¶æ•°æ®é‡ï¼š</label>
                    <div class="input-with-unit">
                        <input type="number" id="numbersPerFile" class="number-input" min="1" max="100" value="40" step="1">
                        <div class="unit-label">ä¸‡/æ–‡ä»¶</div>
                    </div>
                    <div class="filename-hint">è®¾ç½®æ¯ä¸ªExcelæ–‡ä»¶åŒ…å«çš„æ•°æ®é‡ï¼ˆå»ºè®®1-100ä¸‡ï¼‰</div>
                    <div class="filename-example">é»˜è®¤ï¼š40ä¸‡/æ–‡ä»¶</div>
                </div>
            </div>
            
            <div class="input-group">
                <label class="input-label"><i>ğŸ“</i> è¯·è¾“å…¥å·ç æ®µè§„åˆ™ï¼š</label>
                <textarea id="dataInput">å¼€å¤´:
000-000
000</textarea>
            </div>
        </div>
        
        <div class="controls">
            <button class="generate-btn" id="generateBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                å¼€å§‹ç”Ÿæˆæ–‡ä»¶
            </button>
            <button class="reset-btn" id="resetBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                    <path d="M3 3v5h5"></path>
                </svg>
                é‡ç½®
            </button>
        </div>
        
        <div class="status-section">
            <div class="status-header">
                <div class="status-title">ç”ŸæˆçŠ¶æ€</div>
                <div id="statusText">ç­‰å¾…ç”Ÿæˆ...</div>
            </div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-value" id="totalCount">0</div>
                    <div class="stat-label">æ€»æ•°æ®é‡</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="fileCount">0</div>
                    <div class="stat-label">æ–‡ä»¶æ•°é‡</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="groupCount">0</div>
                    <div class="stat-label">å·ç ç»„æ•°</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="uniqueCount">0</div>
                    <div class="stat-label">å»é‡åæ•°é‡</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="fileSize">40ä¸‡</div>
                    <div class="stat-label">æ¯æ–‡ä»¶æ•°æ®é‡</div>
                </div>
            </div>
            
            <div class="loading" id="loadingIndicator">
                <div class="spinner"></div>
                <div class="loading-text">æ­£åœ¨ç”Ÿæˆæ•°æ®ï¼Œè¯·ç¨å€™...</div>
            </div>
        </div>
        
        <div class="file-list">
            <div class="file-list-header">ç”Ÿæˆçš„æ–‡ä»¶åˆ—è¡¨</div>
            <div id="fileList">
                <!-- ç”Ÿæˆçš„æ–‡ä»¶åˆ—è¡¨å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
            </div>
        </div>
        
        <!-- æ•°æ®å»é‡å·¥å…· -->
        <div class="upload-section">
            <div class="upload-header">
                <div class="upload-title">æ•°æ®å»é‡å·¥å…·</div>
                <div id="uploadStatus">ç­‰å¾…ä¸Šä¼ æ–‡ä»¶...</div>
            </div>
            
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ“¤</div>
                <div class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ä¸Šä¼ </div>
                <div class="upload-hint">æ”¯æŒExcel(.xlsx, .xls)æˆ–æ–‡æœ¬æ–‡ä»¶(.txt, .csv)</div>
                <button class="upload-btn" id="selectFileBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    é€‰æ‹©æ–‡ä»¶
                </button>
                <input type="file" id="fileInput" accept=".xlsx,.xls,.txt,.csv" style="display: none;">
            </div>
            
            <div class="upload-results" id="uploadResults" style="display: none;">
                <div class="result-item">
                    <span class="result-label">æ–‡ä»¶åï¼š</span>
                    <span class="result-value" id="uploadFileName"></span>
                </div>
                <div class="result-item">
                    <span class="result-label">åŸå§‹æ•°æ®é‡ï¼š</span>
                    <span class="result-value" id="originalCount">0</span>
                </div>
                <div class="result-item">
                    <span class="result-label">é‡å¤æ•°æ®é‡ï¼š</span>
                    <span class="result-value" id="duplicateCount">0</span>
                </div>
                <div class="result-item">
                    <span class="result-label">å»é‡åæ•°é‡ï¼š</span>
                    <span class="result-value" id="cleanCount">0</span>
                </div>
                <a href="#" class="download-clean-btn" id="downloadCleanBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    ä¸‹è½½å»é‡åæ•°æ®
                </a>
            </div>
        </div>
        
        <!-- æŒ‰å·ç å¼€å¤´è‡ªåŠ¨åˆ†ç±»æ–‡ä»¶å·¥å…· -->
        <div class="classification-section">
            <div class="classification-header">
                <div class="classification-title">æŒ‰å·ç å¼€å¤´è‡ªåŠ¨åˆ†ç±»æ–‡ä»¶å·¥å…·</div>
                <div id="classificationStatus">ç­‰å¾…ä¸Šä¼ æ–‡ä»¶...</div>
            </div>
            
            <div class="classification-options">
                <div class="option-group">
                    <span class="option-label">å·ç å‰ç¼€é•¿åº¦ï¼š</span>
                    <select id="prefixLength" class="prefix-length-select">
                        <option value="3">3ä½ (å¦‚: 046)</option>
                        <option value="4" selected>4ä½ (å¦‚: 0462)</option>
                        <option value="5">5ä½ (å¦‚: 04620)</option>
                        <option value="6">6ä½ (å¦‚: 046207)</option>
                        <option value="7">7ä½ (å¦‚: 0462077)</option>
                    </select>
                </div>
                
                <div class="option-group">
                    <input type="checkbox" id="includeFullNumber" checked>
                    <label for="includeFullNumber" class="option-label">åŒ…å«å®Œæ•´å·ç ï¼ˆä¸å‹¾é€‰åˆ™åªä¿ç•™å‰ç¼€åçš„æ•°å­—ï¼‰</label>
                </div>
            </div>
            
            <div class="classification-area" id="classificationArea">
                <div class="classification-icon">ğŸ“</div>
                <div class="classification-text">ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ä¸Šä¼ </div>
                <div class="classification-hint">æ”¯æŒExcel(.xlsx, .xls)æˆ–æ–‡æœ¬æ–‡ä»¶(.txt, .csv)ï¼Œå°†æŒ‰å·ç å¼€å¤´è‡ªåŠ¨åˆ†ç±»</div>
                <button class="classification-btn" id="selectClassifyFileBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    é€‰æ‹©åˆ†ç±»æ–‡ä»¶
                </button>
                <input type="file" id="classifyFileInput" accept=".xlsx,.xls,.txt,.csv" style="display: none;">
            </div>
            
            <div class="classification-results" id="classificationResults">
                <div class="results-header">åˆ†ç±»ç»“æœ</div>
                
                <div class="classification-stats">
                    <div class="classification-stat">
                        <div class="stat-number" id="classifyFileName">-</div>
                        <div class="stat-desc">æ–‡ä»¶å</div>
                    </div>
                    <div class="classification-stat">
                        <div class="stat-number" id="totalNumbersCount">0</div>
                        <div class="stat-desc">æ€»å·ç æ•°</div>
                    </div>
                    <div class="classification-stat">
                        <div class="stat-number" id="uniquePrefixesCount">0</div>
                        <div class="stat-desc">ä¸åŒå‰ç¼€æ•°</div>
                    </div>
                    <div class="classification-stat">
                        <div class="stat-number" id="maxNumbersPrefix">-</div>
                        <div class="stat-desc">æœ€å¤šå·ç å‰ç¼€</div>
                    </div>
                </div>
                
                <div class="results-header">å‰ç¼€åˆ†ç±»è¯¦æƒ…</div>
                <div class="classification-list" id="classificationList">
                    <!-- å‰ç¼€åˆ—è¡¨å°†åŠ¨æ€ç”Ÿæˆåœ¨è¿™é‡Œ -->
                </div>
                
                <div class="actions-row">
                    <a href="#" class="download-all-btn" id="downloadAllClassifyBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        ä¸‹è½½æ‰€æœ‰åˆ†ç±»æ–‡ä»¶
                    </a>
                    
                    <button class="reset-btn" id="resetClassifyBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                            <path d="M3 3v5h5"></path>
                        </svg>
                        é‡ç½®åˆ†ç±»
                    </button>
                </div>
            </div>
        </div>
        
        <div class="example-section">
            <div class="example-title">è¾“å…¥æ ¼å¼ç¤ºä¾‹ï¼š</div>
            <div class="example-content">å¼€å¤´:0455
730-739 (ç­‰åŒäº730ä¸€ç›´åŠ åˆ°739)
720~729 (ç­‰åŒäº720ä¸€ç›´åŠ åˆ°729)
750è‡³759 (ç­‰åŒäº750ä¸€ç›´åŠ åˆ°759)

å¼€å¤´:0453
301-309
310~319
501
583
660</div>
        </div>
        
        <div class="note">
            æ³¨æ„ï¼šç”±äºæµè§ˆå™¨é™åˆ¶ï¼Œç”Ÿæˆå¤§é‡æ•°æ®å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚æ¯ä¸ªExcelæ–‡ä»¶åŒ…å«çš„æ•°æ®é‡å¯è‡ªå®šä¹‰ï¼Œæ‰€æœ‰æ•°æ®å·²æ‰“ä¹±é¡ºåºï¼Œæ— é‡å¤ã€‚
        </div>
    </div>

    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script>
        // æ ¼å¼è‡ªåŠ¨ä¿®æ­£å‡½æ•°
        function normalizeInputFormat(inputText) {
            const lines = inputText.split('\n');
            const normalizedLines = [];
            
            for (const line of lines) {
                let normalizedLine = line.trim();
                
                // å¤„ç†"xxx-xxx"æ ¼å¼
                const rangeMatch = normalizedLine.match(/^(\d+)\s*-\s*(\d+)$/);
                if (rangeMatch) {
                    const start = rangeMatch[1];
                    const end = rangeMatch[2];
                    normalizedLine = `${start}ä¸€ç›´åŠ åˆ°${end}`;
                }
                
                // å¤„ç†"xxx~xxx"æ ¼å¼
                const tildeMatch = normalizedLine.match(/^(\d+)\s*~\s*(\d+)$/);
                if (tildeMatch) {
                    const start = tildeMatch[1];
                    const end = tildeMatch[2];
                    normalizedLine = `${start}ä¸€ç›´åŠ åˆ°${end}`;
                }
                
                // å¤„ç†"xxxè‡³xxx"æ ¼å¼
                const chineseMatch = normalizedLine.match(/^(\d+)\s*è‡³\s*(\d+)$/);
                if (chineseMatch) {
                    const start = chineseMatch[1];
                    const end = chineseMatch[2];
                    normalizedLine = `${start}ä¸€ç›´åŠ åˆ°${end}`;
                }
                
                normalizedLines.push(normalizedLine);
            }
            
            return normalizedLines.join('\n');
        }

        // è§£æè¾“å…¥æ•°æ®
        function parseInputData(inputText) {
            // å…ˆè¿›è¡Œæ ¼å¼æ ‡å‡†åŒ–
            const normalizedText = normalizeInputFormat(inputText);
            const lines = normalizedText.split('\n').map(line => line.trim()).filter(line => line);
            const data = {};
            let currentPrefix = null;
            
            lines.forEach(line => {
                // æ£€æŸ¥æ˜¯å¦æ˜¯"å¼€å¤´:"æ ¼å¼
                if (line.startsWith('å¼€å¤´:')) {
                    currentPrefix = line.replace('å¼€å¤´:', '').trim();
                    if (!data[currentPrefix]) {
                        data[currentPrefix] = [];
                    }
                } 
                // æ£€æŸ¥æ˜¯å¦æ˜¯"xxxä¸€ç›´åŠ åˆ°xxx"æ ¼å¼
                else if (line.includes('ä¸€ç›´åŠ åˆ°')) {
                    if (!currentPrefix) {
                        console.error('é”™è¯¯: åœ¨æŒ‡å®šå‰ç¼€ä¹‹å‰å‘ç°äº†èŒƒå›´æ•°æ®');
                        return;
                    }
                    
                    const rangeMatch = line.match(/(\d+)\s*ä¸€ç›´åŠ åˆ°\s*(\d+)/);
                    if (rangeMatch) {
                        const start = parseInt(rangeMatch[1]);
                        const end = parseInt(rangeMatch[2]);
                        
                        for (let i = start; i <= end; i++) {
                            data[currentPrefix].push(i.toString().padStart(3, '0'));
                        }
                    }
                } 
                // æ£€æŸ¥æ˜¯å¦æ˜¯å•ä¸ªæ•°å­—
                else if (/^\d+$/.test(line)) {
                    if (!currentPrefix) {
                        console.error('é”™è¯¯: åœ¨æŒ‡å®šå‰ç¼€ä¹‹å‰å‘ç°äº†æ•°å­—');
                        return;
                    }
                    
                    data[currentPrefix].push(line.padStart(3, '0'));
                }
            });
            
            return data;
        }
        
        // ç”Ÿæˆæ‰€æœ‰å·ç 
        function generateAllNumbers(data) {
            const allNumbers = [];
            
            for (const [prefix, middles] of Object.entries(data)) {
                for (const middle of middles) {
                    for (let i = 1; i <= 9999; i++) {
                        const suffix = i.toString().padStart(4, '0');
                        allNumbers.push(prefix + middle + suffix);
                    }
                }
            }
            
            return allNumbers;
        }
        
        // æ‰“ä¹±æ•°ç»„é¡ºåº (Fisher-Yatesæ´—ç‰Œç®—æ³•)
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // åˆ›å»ºExcelæ–‡ä»¶
        function createExcelFile(numbers, fileName) {
            // å°†æ•°å­—æ•°ç»„è½¬æ¢ä¸ºå·¥ä½œè¡¨æ•°æ®
            const worksheetData = numbers.map(number => [number]);
            
            // æ·»åŠ è¡¨å¤´
            worksheetData.unshift(['æ‰‹æœºå·ç ']);
            
            // åˆ›å»ºå·¥ä½œè¡¨
            const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
            
            // è®¾ç½®åˆ—å®½
            worksheet['!cols'] = [{ wch: 15 }];
            
            // åˆ›å»ºå·¥ä½œç°¿
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "æ•°æ®");
            
            // å†™å…¥æ–‡ä»¶
            XLSX.writeFile(workbook, fileName);
            
            return {
                name: fileName,
                size: numbers.length,
                url: "#"
            };
        }
        
        // æ›´æ–°UIçŠ¶æ€
        function updateStatus(text, progress) {
            document.getElementById('statusText').textContent = text;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats(total, files, groups, unique, fileSize) {
            document.getElementById('totalCount').textContent = total.toLocaleString();
            document.getElementById('fileCount').textContent = files.toLocaleString();
            document.getElementById('groupCount').textContent = groups.toLocaleString();
            document.getElementById('uniqueCount').textContent = unique.toLocaleString();
            
            // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°æ˜¾ç¤º
            document.getElementById('fileSize').textContent = fileSize + 'ä¸‡';
        }
        
        // æ·»åŠ æ–‡ä»¶åˆ°åˆ—è¡¨
        function addFileToList(file, fileIndex) {
            const fileList = document.getElementById('fileList');
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            
            // æ–‡ä»¶ç±»å‹å›¾æ ‡
            const fileTypes = ['ğŸ“Š', 'ğŸ“ˆ', 'ğŸ“‰', 'ğŸ“‡', 'ğŸ“', 'ğŸ“‚', 'ğŸ“…', 'ğŸ“†'];
            const fileIcon = fileTypes[fileIndex % fileTypes.length];
            
            fileItem.innerHTML = `
                <div class="file-info">
                    <div class="file-icon">${fileIcon}</div>
                    <div class="file-details">
                        <div class="file-name">${file.name}</div>
                        <div class="file-size">${file.size.toLocaleString()} æ¡æ•°æ®</div>
                    </div>
                </div>
                <a href="${file.url}" download="${file.name}" class="download-btn">ä¸‹è½½æ–‡ä»¶</a>
            `;
            
            fileList.appendChild(fileItem);
        }
        
        // ä¸»ç”Ÿæˆå‡½æ•°
        function generateFiles() {
            const inputText = document.getElementById('dataInput').value;
            const filename = document.getElementById('filenameInput').value || 'å·ç æ•°æ®';
            const numbersPerFileInput = document.getElementById('numbersPerFile');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const fileList = document.getElementById('fileList');
            
            // éªŒè¯æ–‡ä»¶å
            if (!filename.trim()) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ–‡ä»¶åï¼');
                document.getElementById('filenameInput').focus();
                return;
            }
            
            // è·å–å¹¶éªŒè¯æ¯æ–‡ä»¶æ•°æ®é‡ï¼ˆå•ä½ï¼šä¸‡ï¼‰
            let numbersPerFile = parseInt(numbersPerFileInput.value);
            if (isNaN(numbersPerFile) || numbersPerFile < 1) {
                alert('æ¯æ–‡ä»¶æ•°æ®é‡å¿…é¡»æ˜¯1-100ä¸‡ä¹‹é—´çš„æ•°å­—ï¼');
                numbersPerFileInput.focus();
                return;
            }
            
            if (numbersPerFile > 100) {
                if (!confirm(`æ‚¨è®¾ç½®äº†æ¯ä¸ªæ–‡ä»¶ ${numbersPerFile} ä¸‡æ¡æ•°æ®ï¼Œè¿™å¯èƒ½ä½¿æ–‡ä»¶è¿‡å¤§ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ`)) {
                    numbersPerFileInput.focus();
                    return;
                }
            }
            
            // è½¬æ¢ä¸ºå®é™…æ¡æ•°
            const numbersPerFileInCount = numbersPerFile * 10000;
            
            // æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
            loadingIndicator.style.display = 'block';
            fileList.innerHTML = '';
            
            // è§£æè¾“å…¥æ•°æ®
            updateStatus('æ­£åœ¨è§£æè¾“å…¥æ•°æ®...', 10);
            const parsedData = parseInputData(inputText);
            console.log('è§£æçš„æ•°æ®:', parsedData);
            
            // è®¡ç®—æ€»ç»„æ•°
            let totalGroups = 0;
            for (const middles of Object.values(parsedData)) {
                totalGroups += middles.length;
            }
            
            // ç”Ÿæˆæ‰€æœ‰å·ç 
            updateStatus('æ­£åœ¨ç”Ÿæˆå·ç åºåˆ—...', 30);
            const allNumbers = generateAllNumbers(parsedData);
            console.log(`ç”Ÿæˆäº† ${allNumbers.length.toLocaleString()} æ¡æ•°æ®`);
            
            // æ‰“ä¹±é¡ºåº
            updateStatus('æ­£åœ¨æ‰“ä¹±æ•°æ®é¡ºåº...', 50);
            const shuffledNumbers = shuffleArray(allNumbers);
            
            // å»é‡
            updateStatus('æ­£åœ¨å»é™¤é‡å¤æ•°æ®...', 70);
            const uniqueNumbers = [...new Set(shuffledNumbers)];
            
            // è®¡ç®—æ–‡ä»¶æ•°é‡
            const totalFiles = Math.ceil(uniqueNumbers.length / numbersPerFileInCount);
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateStats(allNumbers.length, totalFiles, totalGroups, uniqueNumbers.length, numbersPerFile);
            
            // åˆ›å»ºExcelæ–‡ä»¶
            updateStatus('æ­£åœ¨åˆ›å»ºExcelæ–‡ä»¶...', 90);
            
            // æ¨¡æ‹Ÿåˆ›å»ºæ–‡ä»¶ï¼ˆåœ¨æµè§ˆå™¨ä¸­å®é™…ç”Ÿæˆï¼‰
            setTimeout(() => {
                for (let i = 0; i < totalFiles; i++) {
                    const startIdx = i * numbersPerFileInCount;
                    const endIdx = Math.min(startIdx + numbersPerFileInCount, uniqueNumbers.length);
                    const fileNumbers = uniqueNumbers.slice(startIdx, endIdx);
                    
                    // ç”Ÿæˆæ–‡ä»¶å
                    const fileName = i === 0 ? 
                        `${filename}.xlsx` : 
                        `${filename}_${i+1}.xlsx`;
                    
                    // åˆ›å»ºå¹¶ä¸‹è½½æ–‡ä»¶
                    const file = createExcelFile(fileNumbers, fileName);
                    addFileToList(file, i);
                    
                    // æ›´æ–°è¿›åº¦
                    updateStatus(`æ­£åœ¨ç”Ÿæˆæ–‡ä»¶ ${i+1}/${totalFiles}...`, 90 + (i+1)/totalFiles * 10);
                }
                
                // å®Œæˆ
                updateStatus('æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼', 100);
                loadingIndicator.style.display = 'none';
                
                // æç¤ºç”¨æˆ·
                alert(`æ–‡ä»¶ç”Ÿæˆå®Œæˆï¼å…±åˆ›å»ºäº† ${totalFiles} ä¸ªExcelæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶åŒ…å« ${Math.min(numbersPerFileInCount, uniqueNumbers.length).toLocaleString()} æ¡æ•°æ®ï¼Œæ€»è®¡ ${uniqueNumbers.length.toLocaleString()} æ¡ä¸é‡å¤æ•°æ®ã€‚`);
                
            }, 1000); // æ·»åŠ çŸ­æš‚å»¶è¿Ÿä»¥ä¾¿UIæ›´æ–°
        }
        
        // é‡ç½®åŠŸèƒ½
        function resetApp() {
            document.getElementById('filenameInput').value = '0455å®‰è¾¾å¸‚-0453ç©†é™µå¸‚';
            document.getElementById('numbersPerFile').value = '40';
            document.getElementById('dataInput').value = `å¼€å¤´:0455
730-739
720~729
750è‡³759

å¼€å¤´:0453
301-309
310~319
501
583
660`;
            
            document.getElementById('statusText').textContent = 'ç­‰å¾…ç”Ÿæˆ...';
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('fileList').innerHTML = '';
            document.getElementById('loadingIndicator').style.display = 'none';
            
            updateStats(0, 0, 0, 0, 40);
        }
        
        // ä¸Šä¼ æ–‡ä»¶åŠŸèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('fileInput');
            const uploadArea = document.getElementById('uploadArea');
            const uploadStatus = document.getElementById('uploadStatus');
            const uploadResults = document.getElementById('uploadResults');
            const selectFileBtn = document.getElementById('selectFileBtn');
            const downloadCleanBtn = document.getElementById('downloadCleanBtn');
            
            let cleanNumbers = [];
            
            // ç‚¹å‡»ä¸Šä¼ åŒºåŸŸè§¦å‘æ–‡ä»¶é€‰æ‹©
            uploadArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            // é€‰æ‹©æ–‡ä»¶æŒ‰é’®
            selectFileBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                fileInput.click();
            });
            
            // æ‹–æ”¾åŠŸèƒ½
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#4d90fe';
                uploadArea.style.backgroundColor = '#f5f7fa';
            });
            
            uploadArea.addEventListener('dragleave', function() {
                uploadArea.style.borderColor = '#c3cfe2';
                uploadArea.style.backgroundColor = '';
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.style.borderColor = '#c3cfe2';
                uploadArea.style.backgroundColor = '';
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleFileUpload(fileInput.files[0]);
                }
            });
            
            // æ–‡ä»¶é€‰æ‹©å˜åŒ–
            fileInput.addEventListener('change', function() {
                if (fileInput.files.length) {
                    handleFileUpload(fileInput.files[0]);
                }
            });
            
            // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
            function handleFileUpload(file) {
                uploadStatus.textContent = 'æ­£åœ¨å¤„ç†æ–‡ä»¶...';
                uploadResults.style.display = 'none';
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        let numbers = [];
                        
                        // æ£€æŸ¥æ–‡ä»¶ç±»å‹
                        if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                            // å¤„ç†Excelæ–‡ä»¶
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { type: 'array' });
                            const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                            
                            // æå–ç¬¬ä¸€åˆ—æ•°æ®
                            numbers = jsonData.slice(1).map(row => row[0] ? row[0].toString() : '').filter(num => num);
                        } else {
                            // å¤„ç†æ–‡æœ¬æ–‡ä»¶
                            const content = e.target.result;
                            numbers = content.split('\n').map(line => line.trim()).filter(line => line);
                        }
                        
                        // å»é‡å¤„ç†
                        const uniqueNumbers = [...new Set(numbers)];
                        const duplicateCount = numbers.length - uniqueNumbers.length;
                        
                        // æ›´æ–°UI
                        document.getElementById('uploadFileName').textContent = file.name;
                        document.getElementById('originalCount').textContent = numbers.length.toLocaleString();
                        document.getElementById('duplicateCount').textContent = duplicateCount.toLocaleString();
                        document.getElementById('cleanCount').textContent = uniqueNumbers.length.toLocaleString();
                        
                        cleanNumbers = uniqueNumbers;
                        uploadResults.style.display = 'block';
                        uploadStatus.textContent = 'æ–‡ä»¶å¤„ç†å®Œæˆï¼';
                        
                    } catch (error) {
                        console.error('æ–‡ä»¶å¤„ç†é”™è¯¯:', error);
                        uploadStatus.textContent = 'æ–‡ä»¶å¤„ç†å¤±è´¥: ' + error.message;
                    }
                };
                
                if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                    reader.readAsArrayBuffer(file);
                } else {
                    reader.readAsText(file);
                }
            }
            
            // ä¸‹è½½å»é‡åçš„æ•°æ®
            downloadCleanBtn.addEventListener('click', function(e) {
                e.preventDefault();
                
                if (cleanNumbers.length === 0) {
                    alert('æ²¡æœ‰å¯ä¸‹è½½çš„æ•°æ®ï¼');
                    return;
                }
                
                // åˆ›å»ºExcelæ–‡ä»¶
                const worksheetData = cleanNumbers.map(number => [number]);
                worksheetData.unshift(['æ‰‹æœºå·ç ']);
                
                const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
                worksheet['!cols'] = [{ wch: 15 }];
                
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "å»é‡æ•°æ®");
                
                // ç”Ÿæˆæ–‡ä»¶å
                const originalName = document.getElementById('uploadFileName').textContent;
                const fileName = originalName.includes('.') ? 
                    originalName.replace(/\.[^/.]+$/, '') + '_å»é‡.xlsx' : 
                    originalName + '_å»é‡.xlsx';
                
                // ä¸‹è½½æ–‡ä»¶
                XLSX.writeFile(workbook, fileName);
            });
            
            // åˆ†ç±»åŠŸèƒ½å˜é‡
            const classifyFileInput = document.getElementById('classifyFileInput');
            const classificationArea = document.getElementById('classificationArea');
            const classificationStatus = document.getElementById('classificationStatus');
            const classificationResults = document.getElementById('classificationResults');
            const selectClassifyFileBtn = document.getElementById('selectClassifyFileBtn');
            const downloadAllClassifyBtn = document.getElementById('downloadAllClassifyBtn');
            const resetClassifyBtn = document.getElementById('resetClassifyBtn');
            const prefixLengthSelect = document.getElementById('prefixLength');
            
            let classificationData = {}; // å­˜å‚¨åˆ†ç±»æ•°æ®
            let originalFileName = '';   // å­˜å‚¨åŸå§‹æ–‡ä»¶å
            
            // ç‚¹å‡»åˆ†ç±»åŒºåŸŸè§¦å‘æ–‡ä»¶é€‰æ‹©
            classificationArea.addEventListener('click', function() {
                classifyFileInput.click();
            });
            
            // é€‰æ‹©æ–‡ä»¶æŒ‰é’®
            selectClassifyFileBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                classifyFileInput.click();
            });
            
            // æ‹–æ”¾åŠŸèƒ½
            classificationArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                classificationArea.style.borderColor = '#ea4335';
                classificationArea.style.backgroundColor = '#fef5f5';
            });
            
            classificationArea.addEventListener('dragleave', function() {
                classificationArea.style.borderColor = '#c3cfe2';
                classificationArea.style.backgroundColor = '';
            });
            
            classificationArea.addEventListener('drop', function(e) {
                e.preventDefault();
                classificationArea.style.borderColor = '#c3cfe2';
                classificationArea.style.backgroundColor = '';
                
                if (e.dataTransfer.files.length) {
                    classifyFileInput.files = e.dataTransfer.files;
                    handleClassifyFileUpload(classifyFileInput.files[0]);
                }
            });
            
            // æ–‡ä»¶é€‰æ‹©å˜åŒ–
            classifyFileInput.addEventListener('change', function() {
                if (classifyFileInput.files.length) {
                    handleClassifyFileUpload(classifyFileInput.files[0]);
                }
            });
            
            // é‡ç½®åˆ†ç±»æŒ‰é’®
            resetClassifyBtn.addEventListener('click', function() {
                resetClassification();
            });
            
            // å‰ç¼€é•¿åº¦é€‰æ‹©å˜åŒ–
            prefixLengthSelect.addEventListener('change', function() {
                if (Object.keys(classificationData).length > 0) {
                    reprocessClassification();
                }
            });
            
            // å¤„ç†æ–‡ä»¶åˆ†ç±»ä¸Šä¼ 
            function handleClassifyFileUpload(file) {
                originalFileName = file.name;
                classificationStatus.textContent = 'æ­£åœ¨å¤„ç†æ–‡ä»¶...';
                classificationResults.style.display = 'none';
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        let numbers = [];
                        
                        // æ£€æŸ¥æ–‡ä»¶ç±»å‹
                        if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                            // å¤„ç†Excelæ–‡ä»¶
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { type: 'array' });
                            const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                            
                            // æå–ç¬¬ä¸€åˆ—æ•°æ®
                            numbers = jsonData.slice(1)
                                .map(row => row[0] ? row[0].toString().trim() : '')
                                .filter(num => num && /^\d+$/.test(num));
                        } else {
                            // å¤„ç†æ–‡æœ¬æ–‡ä»¶
                            const content = e.target.result;
                            numbers = content.split('\n')
                                .map(line => line.trim())
                                .filter(line => line && /^\d+$/.test(line));
                        }
                        
                        // åˆ†ç±»å¤„ç†
                        classifyNumbers(numbers);
                        
                    } catch (error) {
                        console.error('æ–‡ä»¶å¤„ç†é”™è¯¯:', error);
                        classificationStatus.textContent = 'æ–‡ä»¶å¤„ç†å¤±è´¥: ' + error.message;
                    }
                };
                
                if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                    reader.readAsArrayBuffer(file);
                } else {
                    reader.readAsText(file);
                }
            }
            
            // åˆ†ç±»å·ç å‡½æ•°
            function classifyNumbers(numbers) {
                const prefixLength = parseInt(prefixLengthSelect.value);
                const includeFullNumber = document.getElementById('includeFullNumber').checked;
                
                classificationData = {};
                
                // ç»Ÿè®¡æ¯ä¸ªå‰ç¼€
                numbers.forEach(number => {
                    if (number.length >= prefixLength) {
                        const prefix = number.substring(0, prefixLength);
                        const suffix = includeFullNumber ? number : number.substring(prefixLength);
                        
                        if (!classificationData[prefix]) {
                            classificationData[prefix] = [];
                        }
                        
                        classificationData[prefix].push(suffix);
                    } else {
                        // å¦‚æœå·ç é•¿åº¦ä¸è¶³å‰ç¼€é•¿åº¦ï¼Œä½¿ç”¨å®Œæ•´å·ç 
                        if (!classificationData['other']) {
                            classificationData['other'] = [];
                        }
                        classificationData['other'].push(number);
                    }
                });
                
                // æ›´æ–°UIæ˜¾ç¤ºç»“æœ
                updateClassificationResults(numbers.length);
            }
            
            // é‡æ–°å¤„ç†åˆ†ç±»ï¼ˆå½“é€‰é¡¹æ”¹å˜æ—¶ï¼‰
            function reprocessClassification() {
                if (Object.keys(classificationData).length === 0) return;
                
                // é‡æ–°ç»„åˆæ‰€æœ‰å·ç 
                let allNumbers = [];
                for (const [prefix, suffixes] of Object.entries(classificationData)) {
                    const includeFullNumber = document.getElementById('includeFullNumber').checked;
                    allNumbers = allNumbers.concat(suffixes.map(suffix => 
                        includeFullNumber ? prefix + suffix : prefix + suffix
                    ));
                }
                
                // é‡æ–°åˆ†ç±»
                classifyNumbers(allNumbers);
            }
            
            // æ›´æ–°åˆ†ç±»ç»“æœæ˜¾ç¤º
            function updateClassificationResults(totalCount) {
                const prefixLength = parseInt(prefixLengthSelect.value);
                const prefixes = Object.keys(classificationData);
                const uniquePrefixCount = prefixes.length;
                
                // æ‰¾åˆ°å·ç æœ€å¤šçš„å‰ç¼€
                let maxPrefix = '';
                let maxCount = 0;
                
                prefixes.forEach(prefix => {
                    const count = classificationData[prefix].length;
                    if (count > maxCount) {
                        maxCount = count;
                        maxPrefix = prefix;
                    }
                });
                
                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                document.getElementById('classifyFileName').textContent = originalFileName;
                document.getElementById('totalNumbersCount').textContent = totalCount.toLocaleString();
                document.getElementById('uniquePrefixesCount').textContent = uniquePrefixCount.toLocaleString();
                document.getElementById('maxNumbersPrefix').textContent = maxPrefix ? `${maxPrefix} (${maxCount}ä¸ª)` : '-';
                
                // æ›´æ–°å‰ç¼€åˆ—è¡¨
                const classificationList = document.getElementById('classificationList');
                classificationList.innerHTML = '';
                
                // æŒ‰æ•°é‡é™åºæ’åºå‰ç¼€
                const sortedPrefixes = [...prefixes].filter(p => p !== 'other');
                sortedPrefixes.sort((a, b) => classificationData[b].length - classificationData[a].length);
                
                // å¦‚æœå­˜åœ¨"other"ç»„ï¼Œæ”¾åˆ°æœ€å
                if (classificationData['other']) {
                    sortedPrefixes.push('other');
                }
                
                sortedPrefixes.forEach((prefix, index) => {
                    const count = classificationData[prefix].length;
                    const percentage = ((count / totalCount) * 100).toFixed(1);
                    
                    const item = document.createElement('div');
                    item.className = 'classification-item';
                    item.innerHTML = `
                        <div class="prefix-info">
                            <div class="prefix-badge">${prefix === 'other' ? 'å…¶ä»–' : prefix}</div>
                            <div class="prefix-count">${count.toLocaleString()} ä¸ªå·ç  (${percentage}%)</div>
                        </div>
                        <a href="#" class="download-classify-btn" data-prefix="${prefix}">
                            ä¸‹è½½
                        </a>
                    `;
                    
                    classificationList.appendChild(item);
                });
                
                // ä¸ºæ¯ä¸ªä¸‹è½½æŒ‰é’®æ·»åŠ äº‹ä»¶
                classificationList.querySelectorAll('.download-classify-btn').forEach(btn => {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        const prefix = this.getAttribute('data-prefix');
                        downloadPrefixFile(prefix);
                    });
                });
                
                // æ˜¾ç¤ºç»“æœåŒºåŸŸ
                classificationResults.style.display = 'block';
                classificationStatus.textContent = 'åˆ†ç±»å®Œæˆï¼';
            }
            
            // ä¸‹è½½å•ä¸ªå‰ç¼€æ–‡ä»¶
            function downloadPrefixFile(prefix) {
                const includeFullNumber = document.getElementById('includeFullNumber').checked;
                const numbers = classificationData[prefix];
                
                if (!numbers || numbers.length === 0) {
                    alert('æ²¡æœ‰æ•°æ®å¯ä¸‹è½½ï¼');
                    return;
                }
                
                // å¤„ç†å·ç ï¼ˆå¦‚æœå‹¾é€‰äº†åŒ…å«å®Œæ•´å·ç ï¼Œåˆ™æ·»åŠ å‰ç¼€ï¼‰
                const processedNumbers = includeFullNumber ? 
                    numbers : 
                    numbers.map(suffix => prefix === 'other' ? suffix : prefix + suffix);
                
                // åˆ›å»ºExcelæ–‡ä»¶
                const worksheetData = processedNumbers.map(number => [number]);
                worksheetData.unshift(['æ‰‹æœºå·ç ']);
                
                const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
                worksheet['!cols'] = [{ wch: 15 }];
                
                const workbook = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(workbook, worksheet, "åˆ†ç±»æ•°æ®");
                
                // ç”Ÿæˆæ–‡ä»¶å
                const baseName = originalFileName.includes('.') ? 
                    originalFileName.replace(/\.[^/.]+$/, '') : 
                    originalFileName;
                const displayPrefix = prefix === 'other' ? 'å…¶ä»–å·ç ' : prefix;
                const fileName = `${baseName}_${displayPrefix}.xlsx`;
                
                // ä¸‹è½½æ–‡ä»¶
                XLSX.writeFile(workbook, fileName);
            }
            
            // ä¸‹è½½æ‰€æœ‰åˆ†ç±»æ–‡ä»¶
            downloadAllClassifyBtn.addEventListener('click', function(e) {
                e.preventDefault();
                
                if (Object.keys(classificationData).length === 0) {
                    alert('æ²¡æœ‰æ•°æ®å¯ä¸‹è½½ï¼');
                    return;
                }
                
                const prefixes = Object.keys(classificationData);
                const includeFullNumber = document.getElementById('includeFullNumber').checked;
                
                // åˆ›å»ºZIPæ–‡ä»¶çš„å‡½æ•°
                function downloadAllAsZip() {
                    const zip = new JSZip();
                    
                    // ä¸ºæ¯ä¸ªå‰ç¼€åˆ›å»ºæ–‡ä»¶
                    prefixes.forEach(prefix => {
                        const numbers = classificationData[prefix];
                        
                        if (numbers && numbers.length > 0) {
                            // å¤„ç†å·ç 
                            const processedNumbers = includeFullNumber ? 
                                numbers : 
                                numbers.map(suffix => prefix === 'other' ? suffix : prefix + suffix);
                            
                            // åˆ›å»ºExcelæ–‡ä»¶
                            const worksheetData = processedNumbers.map(number => [number]);
                            worksheetData.unshift(['æ‰‹æœºå·ç ']);
                            
                            const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
                            worksheet['!cols'] = [{ wch: 15 }];
                            
                            const workbook = XLSX.utils.book_new();
                            XLSX.utils.book_append_sheet(workbook, worksheet, "åˆ†ç±»æ•°æ®");
                            
                            // ç”ŸæˆExcelæ–‡ä»¶
                            const displayPrefix = prefix === 'other' ? 'å…¶ä»–å·ç ' : prefix;
                            const fileName = `${displayPrefix}.xlsx`;
                            const excelData = XLSX.write(workbook, { bookType: 'xlsx', type: 'binary' });
                            
                            // æ·»åŠ åˆ°ZIP
                            zip.file(fileName, excelData, { binary: true });
                        }
                    });
                    
                    // ç”ŸæˆZIPæ–‡ä»¶
                    zip.generateAsync({ type: 'blob' }).then(function(content) {
                        // ä¸‹è½½ZIPæ–‡ä»¶
                        const baseName = originalFileName.includes('.') ? 
                            originalFileName.replace(/\.[^/.]+$/, '') : 
                            originalFileName;
                        const zipFileName = `${baseName}_åˆ†ç±»æ–‡ä»¶.zip`;
                        
                        const link = document.createElement('a');
                        link.href = URL.createObjectURL(content);
                        link.download = zipFileName;
                        link.click();
                        
                        setTimeout(() => {
                            URL.revokeObjectURL(link.href);
                        }, 100);
                    });
                }
                
                // æ£€æŸ¥æ˜¯å¦å·²åŠ è½½JSZip
                if (typeof JSZip === 'undefined') {
                    // åŠ¨æ€åŠ è½½JSZipåº“
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js';
                    script.onload = downloadAllAsZip;
                    script.onerror = function() {
                        // å¦‚æœJSZipåŠ è½½å¤±è´¥ï¼Œé€ä¸ªä¸‹è½½æ–‡ä»¶
                        alert('JSZipåº“åŠ è½½å¤±è´¥ï¼Œå°†é€ä¸ªä¸‹è½½æ–‡ä»¶ã€‚');
                        downloadFilesIndividually();
                    };
                    document.head.appendChild(script);
                } else {
                    downloadAllAsZip();
                }
                
                function downloadFilesIndividually() {
                    prefixes.forEach(prefix => {
                        const numbers = classificationData[prefix];
                        
                        if (numbers && numbers.length > 0) {
                            // å¤„ç†å·ç 
                            const processedNumbers = includeFullNumber ? 
                                numbers : 
                                numbers.map(suffix => prefix === 'other' ? suffix : prefix + suffix);
                            
                            // åˆ›å»ºExcelæ–‡ä»¶
                            const worksheetData = processedNumbers.map(number => [number]);
                            worksheetData.unshift(['æ‰‹æœºå·ç ']);
                            
                            const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
                            worksheet['!cols'] = [{ wch: 15 }];
                            
                            const workbook = XLSX.utils.book_new();
                            XLSX.utils.book_append_sheet(workbook, worksheet, "åˆ†ç±»æ•°æ®");
                            
                            // ç”Ÿæˆæ–‡ä»¶å
                            const baseName = originalFileName.includes('.') ? 
                                originalFileName.replace(/\.[^/.]+$/, '') : 
                                originalFileName;
                            const displayPrefix = prefix === 'other' ? 'å…¶ä»–å·ç ' : prefix;
                            const fileName = `${baseName}_${displayPrefix}.xlsx`;
                            
                            // ä¸‹è½½æ–‡ä»¶
                            XLSX.writeFile(workbook, fileName);
                        }
                    });
                    
                    alert(`å·²å¼€å§‹ä¸‹è½½ ${prefixes.length} ä¸ªåˆ†ç±»æ–‡ä»¶ï¼Œè¯·æŸ¥çœ‹æµè§ˆå™¨çš„ä¸‹è½½è®°å½•ã€‚`);
                }
            });
            
            // é‡ç½®åˆ†ç±»åŠŸèƒ½
            function resetClassification() {
                classificationData = {};
                classificationResults.style.display = 'none';
                classificationStatus.textContent = 'ç­‰å¾…ä¸Šä¼ æ–‡ä»¶...';
                document.getElementById('classificationList').innerHTML = '';
                classifyFileInput.value = '';
                
                // é‡ç½®ç»Ÿè®¡ä¿¡æ¯
                document.getElementById('classifyFileName').textContent = '-';
                document.getElementById('totalNumbersCount').textContent = '0';
                document.getElementById('uniquePrefixesCount').textContent = '0';
                document.getElementById('maxNumbersPrefix').textContent = '-';
            }
        });
        
        // äº‹ä»¶ç›‘å¬
        document.getElementById('generateBtn').addEventListener('click', generateFiles);
        document.getElementById('resetBtn').addEventListener('click', resetApp);
        
        // åˆå§‹åŒ–ç»Ÿè®¡ä¿¡æ¯
        updateStats(0, 0, 0, 0, 40);
    </script>
</body>
</html>